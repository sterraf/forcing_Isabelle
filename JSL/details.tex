\section{Details of the formalization}

\subsection{33 replacement instances to rule them all}
We isolated 33 instances of Replacement that are needed to force
$\CH$/$\neg\CH$. The first 14 instances are needed to set up
cardinal arithmetic in $M$. Many of these were already present in
relational form in the \session{ZF-Constructible} library.

\begin{itemize}
\item 7 instances for iteration of operations. For each construct,
  Paulson used one replacement instance in order to have absoluteness,
  and a second one to obtain closure.
  \begin{itemize}
  \item
    Lists
    \isatt{list{\uscore}repl1{\uscore}intf{\uscore}fm},
    \isatt{list{\uscore}repl2{\uscore}intf{\uscore}fm}.
  \item
    Formulas
    \isatt{formula{\uscore}repl1{\uscore}intf{\uscore}fm},
    \isatt{formula{\uscore}repl1{\uscore}intf{\uscore}fm}.
  \item
    Transitive closure (iteration of $\union$)
    \isatt{eclose{\uscore}repl1{\uscore}intf{\uscore}fm},
    \isatt{eclose{\uscore}repl2{\uscore}intf{\uscore}fm}.
  \item
    $n$th element of a list (iteration of the tail operation)
    \isatt{tl{\uscore}repl{\uscore}intf{\uscore}fm}. By transitivity,
    we do not need an instance for closure; the only instance was required
    for absoluteness.
  \end{itemize}
\item
  2 instances for definition of ordertypes.
  \begin{itemize}
  \item \isatt{replacement{\uscore}is{\uscore}order{\uscore}body{\uscore}fm}.
  \item \isatt{replacement{\uscore}is{\uscore}order{\uscore}eq{\uscore}map{\uscore}fm}.
  \end{itemize}
\item 1 instance for definition of cardinal successor.
  \begin{itemize}
  \item
    \isatt{replacement{\uscore}is{\uscore}jump{\uscore}cardinal{\uscore}body{\uscore}fm}.
  \end{itemize}
\item
  4 instances for definitions by well-founded recursion.
  \begin{itemize}
  \item Ordertypes
    \isatt{wfrec{\uscore}replacement{\uscore}order{\uscore}pred{\uscore}fm}.
  \item Rank \isatt{wfrec{\uscore}rank{\uscore}fm}.
  \item Cumulative hierarchy (rank initial segments) \isatt{trans{\uscore}repl{\uscore}HVFrom{\uscore}fm}.
  \item Aleph \isatt{replacement{\uscore}HAleph{\uscore}wfrec{\uscore}repl{\uscore}body{\uscore}fm}.
  \end{itemize}
\end{itemize}

We also need a one extra replacement instance $\psi$ on $M$ for each
$\phi$ of the
previous ones to have them in $M[G]$.
\[
  \psi(x,\alpha,y_1,\dots,y_n) \defi \quine{\alpha = \min \bigl\{
    \beta \mid \exists\tau\in V_\beta.\  \mathit{snd}(x) \forces
    \phi\ [\mathit{fst}(x),\tau,y_1,\dots,y_n]\bigr\}}
\]
In our development, the mapping $\phi\mapsto\psi$ is given by the
$\isatt{ground{\uscore}repl{\uscore}fm}$ function.

That makes 28 instances up to now. For the setup of forcing, we
require the following 5 instances (the first two are  needed for the $\Delta$-system Lemma):

\begin{itemize}
%\verb|replacement_ax2(6)| \verb|replacement_transrec_apply_image_body_fm| seems fake!
\item Recursive construction of sets using a choice function
  \isatt{replacement{\uscore}is{\uscore}trans{\uscore}apply{\uscore}image{\uscore}fm}.
% \item Replacement through  $x\mapsto \check{x}$ \isatt{check{\uscore}replacement{\uscore}fm}.
\item $x\mapsto |x|^M$
  \isatt{Lambda{\uscore}in{\uscore}M{\uscore}fm(is{\uscore}cardinal{\uscore}fm(0,1),0)}.
\item 2 instances for definitions by well-founded recursion \isatt{wfrec{\uscore}Hcheck{\uscore}fm} (check
  names) and \isatt{wfrec{\uscore}Hfrc{\uscore}at{\uscore}fm} (forcing for atomic formulas).
\item Replacement through $x\mapsto \lb\check{x},x\rb$
  \isatt{G{\uscore}dot{\uscore}in{\uscore}M{\uscore}fm} (for the
  definition of $\punto{G}$).
% \item Name of choice functions in $M[G]$ \isatt{repl{\uscore}opname{\uscore}check{\uscore}fm}.
% \item 2 instances for the slalom needed for cardinal preservation by ccc forcing.
\end{itemize}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "independence_ch_isabelle"
%%% ispell-local-dictionary: "american"
%%% End: 
