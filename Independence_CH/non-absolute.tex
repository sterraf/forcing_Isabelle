\section{Relative versions of non-absolute concepts}
\label{sec:relat-vers-non-absol}

The treatment of relativization/internalization described in the
previous sections was enough for Paulson's treatment of
constructibility. This is the case because essentially all the
concepts in the way of proving the consistency of $\AC$ are
absolute, and the treatment of relational versions and relativized notions
could be minimized after proving the relevant absoluteness results:
For example, the lemma \isatt{Union{\uscore}abs},
\[
  M(A) \implies M(z) \implies \isatt{big{\uscore}union}(M, A, z) \longleftrightarrow z = \union
  A
\]
proved under the assumption that $M$ is transitive and nonempty.

Our first attempt to relativize cardinal arithmetic proceeded in the
same way
and we rapidly found out that stating and proving statements like $(||A||
= |A|) ^M$ in a completely relational language was extremely
cumbersome. This observation lead to the discovery of the discipline
expounded in the next subsection.

%% Working
%% in this relational 
%% way with powersets, cardinalities, and the like would be
%% unfeasible. As such, cardinal arithmetic was not put in relative form
%% in \session{ZF-Constructible}.

\subsection{Discipline and tools for relativization}
\label{sec:tools-relativization}
In order to cope with this, we added the missing step from the
literature consisting of relative versions of the various non-absolute
functions and programmed in ML limited automatic facilities that
define the needed concepts, and  state and
prove the requisite lemmas. For instance, consider the 
$\isatt{cardinal}::\tyi \fun \tyi$ function defined in
\session{Isabelle/ZF}. Then the commands
\begin{isabelle}
  \isacommand{relativize}\isamarkupfalse%
  \ \isakeyword{functional}\ {\isachardoublequoteopen}cardinal{\isachardoublequoteclose}\ {\isachardoublequoteopen}cardinal{\isacharunderscore}{\kern0pt}rel{\isachardoublequoteclose}\ \isakeyword{external}\isanewline
  \isacommand{relationalize}\isamarkupfalse%
  \ {\isachardoublequoteopen}cardinal{\isacharunderscore}{\kern0pt}rel{\isachardoublequoteclose}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cardinal{\isachardoublequoteclose}\isanewline
  \isacommand{synthesize}\isamarkupfalse%
  \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cardinal{\isachardoublequoteclose}\ \isakeyword{from{\isacharunderscore}{\kern0pt}definition}\ \isakeyword{assuming}\ {\isachardoublequoteopen}nonempty{\isachardoublequoteclose}%
\end{isabelle}
define the relative cardinal function
$\isatt{cardinal{\uscore}rel}::(\tyi \fun \tyo) \fun \tyi \fun\tyi$
(denoted  $|\cdot|^M$, as expected),
the relational version $\isatt{is{\uscore}cardinal}$ of the latter, the
internalized formula \isatt{is{\uscore}cardinal{\uscore}fm} whose
satisfaction by a set is equivalent to the relational version, and
prove the previous statement (analogous to (\ref{eq:sats_big_union_fm})).
The proof that $\isatt{is{\uscore}cardinal}(M,x,z)$  encodes the
statement $|x|^M = z$ must still be done by hand, since the definition
of $\isatt{cardinal{\uscore}rel}$ already involves some tacit
absoluteness results (“\textit{the least $z \in \Ord$ such that $z
  \approx^M x$}” instead
of “\textit{the least $z \in \Ord^M$ such that $z
  \approx^M x$}”, and the like).

\subsection{Extension of Isabelle/ZF}
\label{sec:extension-isabellezf}
We extended \cite{Delta_System_Lemma-AFP} the material formalized in
Isabelle, from basic results involving function spaces and the
definition of cardinal exponentiation, to a treatment of cofinality
and the Delta System Lemma for $\omega_1$-families. We also included a
concise treatment of the axiom of Dependent Choices $\DC$ and the
general version of Rasiowa-Sikorski Lemma \cite{2018arXiv180705174G}
and a choiceless one for countable preorders.

This material was subsequently put in relative form in our formal
development on transitive class models \cite{Transitive_Models-AFP}
using as an aid the tools from
Section~\ref{sec:tools-relativization}. We also relativized many
original theories appearing in Isabelle/ZF, including the
fundamentals of cardinal arithmetic, the cumulative hierarchy, and the
definition of the $\ale{}$ function.


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "independence_ch_isabelle"
%%% ispell-local-dictionary: "american"
%%% End: 
