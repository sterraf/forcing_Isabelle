\section{The generic extension satisfies Pairing}

An important goal of our work is to show that the  $\ZFC$
axioms hold in the generic extension. We formalize in this section
the corresponding proof for the  Pairing Axiom.

The Pairing Axiom relative to a class $C$ asserts that for all pair of elements
in $C$ there exists another containing exactly them. This is defined in
Paulson's library:

\begin{isabelle}
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ upair\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharbrackleft}i{\isasymRightarrow}o{\isacharcomma}i{\isacharcomma}i{\isacharcomma}i{\isacharbrackright}\ {\isasymRightarrow}\ o{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}upair{\isacharparenleft}C{\isacharcomma}a{\isacharcomma}b{\isacharcomma}z{\isacharparenright}\ {\isacharequal}{\isacharequal}\ a\ {\isasymin}\ z\ {\isasymand}\ b\ {\isasymin}\ z\ {\isasymand}\ {\isacharparenleft}{\isasymforall}x{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ x{\isasymin}z\ {\isasymlongrightarrow}\ x\ {\isacharequal}\ a\ {\isasymor}\ x\ {\isacharequal}\ b{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ upair{\isacharunderscore}ax\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}i{\isasymRightarrow}o{\isacharparenright}\ {\isasymRightarrow}\ o{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}upair{\isacharunderscore}ax{\isacharparenleft}C{\isacharparenright}\ {\isacharequal}{\isacharequal}\ {\isasymforall}x{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ {\isasymforall}y{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ {\isasymexists}z{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ upair{\isacharparenleft}C{\isacharcomma}x{\isacharcomma}y{\isacharcomma}z{\isacharparenright}{\isachardoublequoteclose}
\end{isabelle}

We state the main result of this Section in the context
\isatt{forcing{\isacharunderscore}data}.  Recall that the operator
\isatt{\#\#}  converts a set into a  set into a class (i.e., a predicate):

\begin{isabelle}
  \isanewline
\isacommand{lemma}\isamarkupfalse%
\ pair{\isacharunderscore}preserv\ {\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}one\ {\isasymin}\ G\ {\isasymLongrightarrow}\ upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharparenright}\ {\isasymLongrightarrow}\ upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharbrackleft}G{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}
\end{isabelle}

Let $x$ and $y$ be elements in $M[G]$. By definition of the generic extension, there exist
elements $\tau$ and $\rho$ in $M$ such that $x = \val(G,\tau)$ and
$y = \val(G,\rho)$.  We need to find an element in $M[G]$ that contains exactly
these elements; for that we should construct a name $\sigma\in M$ such that
$\val(G,\sigma) = \{ \val(G,\tau) , \val(G,\rho) \}$. 

The candidate, motivated by the definition of $\chk$,  is
$\sigma = \{\langle \tau , one \rangle , \langle \rho , one \rangle \}$. 
Our remaining tasks are to show 
\begin{enumerate}
  \item \label{item:1}$\sigma \in M$, and
  \item \label{item:2} $\val(G,\sigma) = \{ \val(G,\tau) , \val(G,\rho) \}$
\end{enumerate}

Recall that in $\ZFC$, an ordered pair $\lb x,y \rb$ is the set
$\{\{x\},\{x,y\}\}$. Thus, to show (\ref{item:1}) have to use that the
pairing axiom holds in $M$ and the absoluteness of pairing
thanks to $M$ being transitive. 

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ pairs{\isacharunderscore}in{\isacharunderscore}M\ {\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}\ {\isasymlbrakk}\ upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharparenright}\ {\isacharsemicolon}\ a\ {\isasymin}\ M\ {\isacharsemicolon}\ b\ {\isasymin}\ M\ {\isacharsemicolon}\ c\ {\isasymin}\ M\ {\isacharsemicolon}\ d\ {\isasymin}\ M\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isacharbraceleft}{\isasymlangle}a{\isacharcomma}c{\isasymrangle}{\isacharcomma}{\isasymlangle}b{\isacharcomma}d{\isasymrangle}{\isacharbraceright}\ {\isasymin}\ M{\isachardoublequoteclose}
\end{isabelle}

Item (i) then follows because $\tau$, $\rho$ and
$one$ belong to $M$ (the last fact holds because $one \in P$, $P \in M$ and
$M$ is transitive).

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ sigma{\isacharunderscore}in{\isacharunderscore}M\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharparenright}\ {\isasymLongrightarrow}\ one\ {\isasymin}\ G\ {\isasymLongrightarrow}\ {\isasymtau}\ {\isasymin}\ M\ {\isasymLongrightarrow}\ {\isasymrho}\ {\isasymin}\ M\ {\isasymLongrightarrow}\ {\isacharbraceleft}{\isasymlangle}{\isasymtau}{\isacharcomma}one{\isasymrangle}{\isacharcomma}{\isasymlangle}{\isasymrho}{\isacharcomma}one{\isasymrangle}{\isacharbraceright}\ {\isasymin}\ M{\isachardoublequoteclose}

\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ pairs{\isacharunderscore}in{\isacharunderscore}M{\isacharcomma}simp{\isacharunderscore}all\ add{\isacharcolon}\ upair{\isacharunderscore}ax{\isacharunderscore}def\ one{\isacharunderscore}in{\isacharunderscore}M{\isacharparenright}%
\end{isabelle}

In order to prove (ii), we need the following lemma, characterizing the $\val$ function:

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ def{\isacharunderscore}val{\isacharcolon}\ \ {\isachardoublequoteopen}x{\isasymin}M\ {\isasymLongrightarrow}\ val{\isacharparenleft}G{\isacharcomma}x{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}val{\isacharparenleft}G{\isacharcomma}t{\isacharparenright}\ {\isachardot}{\isachardot}\ t{\isasymin}domain{\isacharparenleft}x{\isacharparenright}\ {\isacharcomma}\ {\isasymexists}p{\isasymin}P\ {\isachardot}\ \ {\isasymlangle}t{\isacharcomma}\ p{\isasymrangle}{\isasymin}x\ {\isasymand}\ p\ {\isasymin}\ G\ {\isacharbraceright}{\isachardoublequoteclose}
\end{isabelle}


Using this lemma and asumming $one \in G$ and $\sigma \in M$, the rest of the proof of (ii) is done almost automatically, 

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ valsigma\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}one\ {\isasymin}\ G\ {\isasymLongrightarrow}\ {\isacharbraceleft}{\isasymlangle}{\isasymtau}{\isacharcomma}one{\isasymrangle}{\isacharcomma}{\isasymlangle}{\isasymrho}{\isacharcomma}one{\isasymrangle}{\isacharbraceright}\ {\isasymin}\ M\ {\isasymLongrightarrow}\isanewline
\ \ \ val{\isacharparenleft}G{\isacharcomma}{\isacharbraceleft}{\isasymlangle}{\isasymtau}{\isacharcomma}one{\isasymrangle}{\isacharcomma}{\isasymlangle}{\isasymrho}{\isacharcomma}one{\isasymrangle}{\isacharbraceright}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}val{\isacharparenleft}G{\isacharcomma}{\isasymtau}{\isacharparenright}{\isacharcomma}val{\isacharparenleft}G{\isacharcomma}{\isasymrho}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}

\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}insert\ one{\isacharunderscore}in{\isacharunderscore}P{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ trans{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ def{\isacharunderscore}val{\isacharcomma}assumption{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Sep{\isacharunderscore}and{\isacharunderscore}Replace{\isacharparenright}\isanewline
\isacommand{done}\isamarkupfalse%
\end{isabelle}

Thereby, with (i) and (ii) the preservation of pairing in $M[G]$ is proved. The rest
of the proof is only bureaucracy so we don't show it.


