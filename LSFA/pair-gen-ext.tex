\section{The generic extension preserves pairing}

An important goal of our work is to formalize the preservation of the $\ZFC$
axioms in the generic extension of the universe $M$. We show in this section
the proof of preservation of the pairing axiom.

The pairing axiom relative to a class $C$ asserts that for all pair of elements
in $C$ there exists another containing exactly them. This is defined in
Paulson's library:

\begin{isabelle}
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ upair\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharbrackleft}i{\isasymRightarrow}o{\isacharcomma}i{\isacharcomma}i{\isacharcomma}i{\isacharbrackright}\ {\isasymRightarrow}\ o{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}upair{\isacharparenleft}C{\isacharcomma}a{\isacharcomma}b{\isacharcomma}z{\isacharparenright}\ {\isacharequal}{\isacharequal}\ a\ {\isasymin}\ z\ {\isasymand}\ b\ {\isasymin}\ z\ {\isasymand}\ {\isacharparenleft}{\isasymforall}x{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ x{\isasymin}z\ {\isasymlongrightarrow}\ x\ {\isacharequal}\ a\ {\isasymor}\ x\ {\isacharequal}\ b{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ upair{\isacharunderscore}ax\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}i{\isasymRightarrow}o{\isacharparenright}\ {\isasymRightarrow}\ o{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}upair{\isacharunderscore}ax{\isacharparenleft}C{\isacharparenright}\ {\isacharequal}{\isacharequal}\ {\isasymforall}x{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ {\isasymforall}y{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ {\isasymexists}z{\isacharbrackleft}C{\isacharbrackright}{\isachardot}\ upair{\isacharparenleft}C{\isacharcomma}x{\isacharcomma}y{\isacharcomma}z{\isacharparenright}{\isachardoublequoteclose}
\end{isabelle}

We enunciate the preservation of pairing in the context \isatt{forcing data}. $M$ is a countable and transitive set, containing the
poset $P$. We uses the operator \isatt{\#\#} to convert the set $M$ into a class:

\begin{isabelle}
  \isanewline
\isacommand{lemma}\isamarkupfalse%
\ pair{\isacharunderscore}preserv\ {\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}one\ {\isasymin}\ G\ {\isasymLongrightarrow}\ upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharparenright}\ {\isasymLongrightarrow}\ upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharbrackleft}G{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}
\end{isabelle}

Let $x$ and $y$ be elements in $M[G]$, by definition of generic extension, there exists
elements $\tau$ and $\rho$ in $M$ such that $x = val(G,\tau)$ and
$y = val(G,\rho)$.  We need to find an element in $M[G]$ that contains exactly
this elements, ie, an element $\sigma$ in $M$ such that
$val(G,\sigma) = \{ val(G,\tau) , val(G,\rho) \}$. Finding this element the proof
is complete. 

The candidate is
$\sigma = \{\langle \tau , one \rangle , \langle \rho , one \rangle \}$. The construction of
this element is similar to those obtained by $check$ function. 
Therefore, all work is reduced to prove the following lemmas:
\begin{enumerate}
  \item $\sigma \in M$, and
  \item $val(G,\sigma) = \{ val(G,\tau) , val(G,\rho) \}$
\end{enumerate}

In the first lemma, we have a set containing two ordered pairs with elements that
belong to $M$. We proved that a set consisting of pairs of elements in $M$ belongs to $M$.
The proof uses strongly that pairing axiom holds in $M$ and the absoluteness of pairing
thanks to $M$ is transitive. 

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ pairs{\isacharunderscore}in{\isacharunderscore}M\ {\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}\ {\isasymlbrakk}\ upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharparenright}\ {\isacharsemicolon}\ a\ {\isasymin}\ M\ {\isacharsemicolon}\ b\ {\isasymin}\ M\ {\isacharsemicolon}\ c\ {\isasymin}\ M\ {\isacharsemicolon}\ d\ {\isasymin}\ M\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isacharbraceleft}{\isasymlangle}a{\isacharcomma}c{\isasymrangle}{\isacharcomma}{\isasymlangle}b{\isacharcomma}d{\isasymrangle}{\isacharbraceright}\ {\isasymin}\ M{\isachardoublequoteclose}
\end{isabelle}

Thus, (i) is an instance of this, because $\tau$, $\rho$ and
$one$ belong to $M$ (the last fact holds because $one \in P$, $P \in M$ and
$M$ is transitive):

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ sigma{\isacharunderscore}in{\isacharunderscore}M\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}upair{\isacharunderscore}ax{\isacharparenleft}{\isacharhash}{\isacharhash}M{\isacharparenright}\ {\isasymLongrightarrow}\ one\ {\isasymin}\ G\ {\isasymLongrightarrow}\ {\isasymtau}\ {\isasymin}\ M\ {\isasymLongrightarrow}\ {\isasymrho}\ {\isasymin}\ M\ {\isasymLongrightarrow}\ {\isacharbraceleft}{\isasymlangle}{\isasymtau}{\isacharcomma}one{\isasymrangle}{\isacharcomma}{\isasymlangle}{\isasymrho}{\isacharcomma}one{\isasymrangle}{\isacharbraceright}\ {\isasymin}\ M{\isachardoublequoteclose}

\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ pairs{\isacharunderscore}in{\isacharunderscore}M{\isacharcomma}simp{\isacharunderscore}all\ add{\isacharcolon}\ upair{\isacharunderscore}ax{\isacharunderscore}def\ one{\isacharunderscore}in{\isacharunderscore}M{\isacharparenright}%
\end{isabelle}

In order to prove (ii), we need the following lemma, characterizing the $val$ function:

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ def{\isacharunderscore}val{\isacharcolon}\ \ {\isachardoublequoteopen}x{\isasymin}M\ {\isasymLongrightarrow}\ val{\isacharparenleft}G{\isacharcomma}x{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}val{\isacharparenleft}G{\isacharcomma}t{\isacharparenright}\ {\isachardot}{\isachardot}\ t{\isasymin}domain{\isacharparenleft}x{\isacharparenright}\ {\isacharcomma}\ {\isasymexists}p{\isasymin}P\ {\isachardot}\ \ {\isasymlangle}t{\isacharcomma}\ p{\isasymrangle}{\isasymin}x\ {\isasymand}\ p\ {\isasymin}\ G\ {\isacharbraceright}{\isachardoublequoteclose}
\end{isabelle}


Using this lemma and asumming $one \in G$ and $\sigma \in M$, the rest of the proof of (ii) is done almost automatically, 

\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ valsigma\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}one\ {\isasymin}\ G\ {\isasymLongrightarrow}\ {\isacharbraceleft}{\isasymlangle}{\isasymtau}{\isacharcomma}one{\isasymrangle}{\isacharcomma}{\isasymlangle}{\isasymrho}{\isacharcomma}one{\isasymrangle}{\isacharbraceright}\ {\isasymin}\ M\ {\isasymLongrightarrow}\isanewline
\ \ \ val{\isacharparenleft}G{\isacharcomma}{\isacharbraceleft}{\isasymlangle}{\isasymtau}{\isacharcomma}one{\isasymrangle}{\isacharcomma}{\isasymlangle}{\isasymrho}{\isacharcomma}one{\isasymrangle}{\isacharbraceright}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}val{\isacharparenleft}G{\isacharcomma}{\isasymtau}{\isacharparenright}{\isacharcomma}val{\isacharparenleft}G{\isacharcomma}{\isasymrho}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}

\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}insert\ one{\isacharunderscore}in{\isacharunderscore}P{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ trans{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ def{\isacharunderscore}val{\isacharcomma}assumption{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Sep{\isacharunderscore}and{\isacharunderscore}Replace{\isacharparenright}\isanewline
\isacommand{done}\isamarkupfalse%
\end{isabelle}

Thereby, with (i) and (ii) the preservation of pairing in $M[G]$ is proved. The rest
of the proof is only bureaucracy so we don't show it.


