%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          
\subsection*{Recursion and Values of Names}

The map $\val$ used in the definition of the generic extension is
characterized by the recursive equation
\begin{equation}
  \label{eq:val}
  \val(G,\tau) = \{val(G,\sigma) :\exists p \in\PP .%
  \lb\sigma,p\rb \in \tau \wedge p \in G \}
\end{equation}

As is well-known, the principle of transfinite recursion on
well-founded relations~\cite[p. 48]{kunen2011set}) allows us to define
a recursive function $F \colon A\to A$ by choosing a well-founded
relation $R \subseteq A\times A$ and a functional
$H\colon A\times (A \to A) \to A$ satisfying
$F(a)=H(a,F\!\upharpoonright\!(R^{-1}(a)))$. \citet{paulson1995set}
made this principle available in Isabelle/ZF via the the operator
\isa{wfrec}. The formalization of the functional $\mathit{Hv}$ is
straightforward:
%
\begin{isabelle}
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ Hv\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}i{\isasymRightarrow}i{\isasymRightarrow}i{\isasymRightarrow}i{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}Hv{\isacharparenleft}G{\isacharcomma}y{\isacharcomma}f{\isacharparenright}\ {\isacharequal}{\isacharequal}\ {\isacharbraceleft}\ f{\isacharbackquote}x\ {\isachardot}{\isachardot}\ x{\isasymin}\ domain{\isacharparenleft}y{\isacharparenright}{\isacharcomma}\ {\isasymexists}p{\isasymin}P{\isachardot}\ {\isacharless}x{\isacharcomma}p{\isachargreater}\ {\isasymin}\ y\ {\isasymand}\ p\ {\isasymin}\ G\ {\isacharbraceright}{\isachardoublequoteclose}
\end{isabelle}
In the references \cite{kunen2011set,weaver2014forcing} $\val$ is
applied only to \emph{names}, that are certain elements of $M$
characterized by a recursively defined predicate. The well-founded
relation used to justify Equation~\eqref{eq:val} is
\[ x \mathrel{\mathit{ed}} y \iff \exists p . \lb x,p\rb\in y. \] In
order to use \isa{wfrec} the relation should be expressed as a set, so
we took the restriction of $\mathit{ed}$ to the whole universe
$M$; i.e. $\mathit{ed}\cap M\times M$.  It was inconvenient to work
with that definition because it imposed an obligation showing that
some set is in $M$. The remedy was to restrict $\mathit{ed}$ to the
transitive closure of the actual parameter:
\begin{isabelle}
\isacommand{definition}\isamarkupfalse%
\isanewline
\ val\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}i{\isasymRightarrow}i{\isasymRightarrow}i{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ {\isachardoublequoteopen}val{\isacharparenleft}G{\isacharcomma}{\isasymtau}{\isacharparenright}{\isacharequal}{\isacharequal}\ wfrec{\isacharparenleft}edrel{\isacharparenleft}eclose{\isacharparenleft}{\isacharbraceleft}{\isasymtau}{\isacharbraceright}{\isacharparenright}{\isacharparenright}{\isacharcomma}{\isasymtau}{\isacharcomma}Hv{\isacharparenleft}G{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}
\end{isabelle}
A key result, albeit intuitive and rather easy, to make this
definition work is that when computing the value of a recursive
function on some argument $a$, one can restrict the relation to some
ambient set if it includes $a$ and all of its predecessesors.
\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ wfrec{\isacharunderscore}restr\ {\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}relation{\isacharparenleft}r{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}wf{\isacharparenleft}r{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}a{\isasymin}A\ {\isasymLongrightarrow}\ {\isacharparenleft}r{\isacharcircum}{\isacharplus}{\isacharparenright}{\isacharminus}{\isacharbackquote}{\isacharbackquote}{\isacharbraceleft}a{\isacharbraceright}\ {\isasymsubseteq}\ A\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ wfrec{\isacharparenleft}r{\isacharcomma}a{\isacharcomma}H{\isacharparenright}\ {\isacharequal}\ wfrec{\isacharparenleft}r{\isasyminter}A{\isasymtimes}A{\isacharcomma}a{\isacharcomma}H{\isacharparenright}{\isachardoublequoteclose}
\end{isabelle}

This lemma gives rise to some useful results about values of
names. First, we characterize $\val$ as in Equation~(\ref{eq:val}):
\begin{isabelle}
  \isacommand{lemma}\isamarkupfalse%
  \ def{\isacharunderscore}val{\isacharcolon}\isanewline
  \ {\isachardoublequoteopen}val{\isacharparenleft}G{\isacharcomma}x{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}val{\isacharparenleft}G{\isacharcomma}t{\isacharparenright}\ {\isachardot}{\isachardot}\ t{\isasymin}domain{\isacharparenleft}x{\isacharparenright}\ {\isacharcomma}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymexists}p{\isasymin}P{\isachardot}\ {\isacharless}t{\isacharcomma}p{\isachargreater}{\isasymin}x\ {\isasymand}\ p{\isasymin}G\ {\isacharbraceright}{\isachardoublequoteclose}
\end{isabelle}
and the monotonicity of $\val$ follows automatically after a
substitution.
\begin{isabelle}
\isacommand{lemma}\isamarkupfalse%
\ val{\isacharunderscore}mono{\isacharcolon}\ {\isachardoublequoteopen}x{\isasymsubseteq}y\ {\isasymLongrightarrow}\ val{\isacharparenleft}G{\isacharcomma}x{\isacharparenright}\ {\isasymsubseteq}\ val{\isacharparenleft}G{\isacharcomma}y{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}{\isadigit{1}}\ {\isadigit{2}}{\isacharparenright}\ def{\isacharunderscore}val{\isacharcomma}\ force{\isacharparenright}%
\end{isabelle}
More interestingly we can give a neat equation for values of
names defined by Separation, say $B = \{x\in A\times \PP.\ Q(x)\}$,
then
\begin{equation}
\val(G,B) = \{\val(G,t) : t\in A , \exists p\in \PP \cap G.\ Q(\lb t,p\rb) \} \label{eq:val-name-sep}
\end{equation}


\fbox{Creo que deberíamos poner acá \isa{check} y \isa{check\_in\_M} }

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "Separation_In_MG"
%%% ispell-local-dictionary: "american"
%%% End: 
